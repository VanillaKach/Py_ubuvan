# Название проекта: "Виджет банковских операций клиента"

---
## Основная идея:

IT-отдел крупного банка делает новую фичу для личного кабинета клиента. 
Это виджет, который показывает несколько последних успешных банковских операций клиента. 
Этот проект на бэкенде будет готовить данные для отображения в новом виджете.

## На данном этапе проекта разработано пять основных рабочих модулей:
```
 --  masks.py  --  widget.py  --  processing.py  --  generators.py  --  decorators.py  --
```
---
## В модуле masks.py были разработаны следующие функции: 

get_mask_card_number():

 -- принимает на вход номер карты и возвращает ее маску. 
    Номер карты замаскирован и отображается в формате 
    XXXX XX** **** XXXX , где X — это цифра номера. 
    То есть видны первые 6 цифр и последние 4 цифры, 
    остальные символы отображаются звездочками, номер разбит по блокам по 4 цифры, 
    разделенным пробелами. 
```
        Пример работы функции:
        7000792289606361     # входной аргумент
        7000 79** **** 6361  # выход функции
```
get_mask_account():

 -- принимает на вход номер счета и возвращает его маску. 
    Номер счета замаскирован и отображается в формате **XXXX , где X
    — это цифра номера. То есть видны только последние 4 цифры номера, 
    а перед ними — две звездочки. 
```
        Пример работы функции:
        73654108430135874305  # входной аргумент
        **4305  # выход функции
```
## Модуль widget.py является более совершенной версией модуля masks.py:

mask_account_card():

 -- Принимает один аргумент — строку, содержащую тип и номер карты или счета.
    Аргументом может быть строка типа Visa Platinum 7000792289606361, или 
    Maestro 7000792289606361, или Счет 73654108430135874305. 
    Разделять строку на 2 аргумента (отдельно имя, отдельно номер) нельзя!
    Возвращает строку с замаскированным номером. Для карт и счетов использует разные типы маскировки. 
```
        Примеры работы функции
        # Пример для карты
        Visa Platinum 7000792289606361  # входной аргумент
        Visa Platinum 7000 79** **** 6361  # выход функции
```
```
        # Пример для счета
        Счет 73654108430135874305  # входной аргумент
        Счет **4305  # выход функции
```
get_date():

 -- принимает на вход строку с датой в формате "2024-03-11T02:26:18.671407"
    и возвращает строку с датой в формате "ДД.ММ.ГГГГ" ("11.03.2024").
 
## Модуль processing.py содержит в себе функции для работы со словарями:

filter_by_state():

 -- принимает список словарей и опционально значение для ключа state
    (по умолчанию 'EXECUTED'). Функция возвращает новый список словарей, 
    содержащий только те словари, у которых ключ state соответствует указанному значению.
```
       Примеры работы функции
        # Выход функции со статусом по умолчанию 'EXECUTED'
        [{'id': 41428829, 'state': 'EXECUTED', 'date': '2019-07-03T18:35:29.512364'}, {'id': 939719570, 'state': 'EXECUTED', 'date': '2018-06-30T02:08:58.425572'}]
```
```
        # Выход функции, если вторым аргументов передано 'CANCELED'
        [{'id': 594226727, 'state': 'CANCELED', 'date': '2018-09-12T21:27:25.241689'}, {'id': 615064591, 'state': 'CANCELED', 'date': '2018-10-14T08:21:33.419441'}]
```
sort_by_date():

 -- принимает список словарей и необязательный параметр, 
    задающий порядок сортировки (по умолчанию — убывание). Функция должна возвращать 
    новый список, отсортированный по дате (date).
```
        Примеры работы функции
        # Выход функции (сортировка по убыванию, т. е. сначала самые последние операции)
        [{'id': 41428829, 'state': 'EXECUTED', 'date': '2019-07-03T18:35:29.512364'}, {'id': 615064591, 'state': 'CANCELED', 'date': '2018-10-14T08:21:33.419441'}, {'id': 594226727, 'state': 'CANCELED', 'date': '2018-09-12T21:27:25.241689'}, {'id': 939719570, 'state': 'EXECUTED', 'date': '2018-06-30T02:08
```

## Модуль generators.py, реализующий генераторы для обработки данных.

filter_by_currency():

 -- принимает на вход список словарей, представляющих транзакции.

transaction_descriptions():

 -- принимает список словарей с транзакциями и возвращает описание каждой операции по очереди.

card_number_generator():

 -- выдает номера банковских карт в формате XXXX XXXX XXXX XXXX , где X
  — цифра номера карты. Генератор может сгенерировать номера карт в заданном диапазоне от 0000 0000 0000 0001 до 9999 9999 9999 9999.

## Модуль decorators.py будет использоваться для размещения декораторов, включая декоратор log.

В нём содержится декоратор 
log, который будет автоматически логировать начало и конец выполнения функции, а также ее результаты или возникшие ошибки.
Декоратор должен принимать необязательный аргумент filename, который определяет, куда будут записываться логи (в файл или в консоль):


# Тестирование модулей:

Добавлено тестирование к основным рабочим модулям. Функции в модулях тестировались следующим образом:

Модуль masks

Функция get_mask_card_number
```
Тестирование правильности маскирования номера карты.
Проверка работы функции на различных входных форматах номеров карт, включая граничные случаи и нестандартные длины номеров.
Проверка, что функция корректно обрабатывает входные строки, где отсутствует номер карты.
```
Функция get_mask_account
```
Тестирование правильности маскирования номера счета.
Проверка работы функции с различными форматами и длинами номеров счетов.
Проверка, что функция корректно обрабатывает входные данные, где номер счета меньше ожидаемой длины.
```
Модуль widget

Функция mask_account_card
```
Тесты для проверки, что функция корректно распознает и применяет нужный тип маскировки в зависимости от типа входных данных (карта или счет).
Параметризованные тесты с разными типами карт и счетов для проверки универсальности функции.
Тестирование функции на обработку некорректных входных данных и проверка ее устойчивости к ошибкам.
```
Функция get_data
```
Тестирование правильности преобразования даты.
Проверка работы функции на различных входных форматах даты, включая граничные случаи и нестандартные строки с датами.
Проверка, что функция корректно обрабатывает входные строки, где отсутствует дата.
```
Модуль processing

Функция filter_by_state
```
Тестирование фильтрации списка словарей по заданному статусу 
state
Проверка работы функции при отсутствии словарей с указанным статусом 
state в списке.
Параметризация тестов для различных возможных значений статуса
state
```
Функция sort_by_date
```
Тестирование сортировки списка словарей по датам в порядке убывания и возрастания.
Проверка корректности сортировки при одинаковых датах.
Тесты на работу функции с некорректными или нестандартными форматами дат.
```
Модуль generators

Функция filter_by_currency
```
Проверка, что функция корректно фильтрует транзакции по заданной валюте.
Тестирование, что функция правильно обрабатывает случаи, когда транзакции в заданной валюте отсутствуют.
Проверка, что генератор не завершается ошибкой при обработке пустого списка или списка без соответствующих валютных операций.
```
Функция transaction_descriptions
```
Проверка, что функция возвращает корректные описания для каждой транзакции.
Тестирование работы функции с различным количеством входных транзакций, включая пустой список.
```
Функция card_number_generator
```
Проверка, что генератор выдает правильные номера карт в заданном диапазоне.
Тестирование, что генератор корректно обрабатывает крайние значения диапазона и правильно завершает генерацию.
Проверка на корректность форматирования номеров карт.
```

Модуль decorators
```
Тестирования вывода в консоль принимает фикстуру capsys, которая позволяет перехватывать вывод данных в консоль.
Тесты покрывают различные сценарии использования декоратора, включая успешное выполнение функций и обработку исключений.
```

## Отчёт о тестировании:
```
---------- coverage: platform linux, python 3.12.3-final-0 -----------
Name                       Stmts   Miss  Cover
----------------------------------------------
main.py                        4      0   100%
src/__init__.py                0      0   100%
src/decorators.py             26      0   100%
src/generators.py             28      1    96%
src/masks.py                  21      2    90%
src/processing.py             10      0   100%
src/widget.py                 28      1    96%
tests/__init__.py              0      0   100%
tests/conftest.py              0      0   100%
tests/test_decorators.py      53      1    98%
tests/test_generators.py      25      0   100%
tests/test_masks.py           18      0   100%
tests/test_processing.py      18      0   100%
tests/test_widget.py          32      0   100%
----------------------------------------------
TOTAL                        263      5    98%
```

## Документация:

Для получения дополнительной информации обратитесь к [документации](docs/README.md).

## Лицензия:

Этот проект лицензирован по [лицензии MIT](LICENSE).
################################################################################################
# Py_ubuvan
